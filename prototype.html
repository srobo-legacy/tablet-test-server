<!DOCTYPE html>
<html>

    <head>
        <meta charset="UTF-8" />
        <title>SR Tablet Frontend</title>

        <link rel="stylesheet" href="http://brick.a.ssl.fastly.net/Lato:400,700" />

        <link href="styles/reset.css" type="text/css" rel="stylesheet" />
        <link href="styles/main.css" type="text/css" rel="stylesheet" />

        <script src="http://momentjs.com/downloads/moment.js"></script>
    </head>

    <body>
        <header>
            <button class="off">Off</button>
            <nav>
                <a href="#status">Status</a><a href="#log" class="active">Log</a><a href="#camera">Camera</a>
            </nav>
            <img src="images/sr-logo.svg" alt="Student Robotics Logo" />
        </header>

        <main>
            <table>
                <tbody>
                </tbody>
            </table>
        </main>

        <script>
            var startDate = moment();

            var isAtBottom = function() {
                var main = document.querySelector("main");
                return Math.abs((main.scrollTop + main.clientHeight) - main.scrollHeight) <= 10;
            };

            var scrollToBottom = function() {
                var main = document.querySelector("main");
                main.scrollTop = main.scrollHeight;
            };

            var log = function(message) {
                var tbody = document.querySelector("main > table tbody");
                var newRow = tbody.insertRow(tbody.rows.length);

                var shouldScroll = isAtBottom();

                var dateStr = moment().format("HH:mm:ss");
                newRow.insertCell(0).appendChild(document.createTextNode(dateStr));

                newRow.insertCell(1).appendChild(document.createTextNode(message));

                if (shouldScroll) {
                    scrollToBottom();
                }
            };

            var randomString = function() {
                var text = "";
                // letter density is based on scrabble tile value
                var letters = "aaaaaaaaaabbbbbbbbccccccccdddddddddeeeeeeeeeefffffffggggggggghhhhhhhiiiiiiiiiijjjkkkkkkllllllllllmmmmmmmmnnnnnnnnnnoooooooooooppppppppqrrrrrrrrrrssssssssssttttttttttuuuuuuuuuuuvvvvvvvwwwwwwwwxxxyyyyyyyz                                        ";
                var length = Math.floor(15 + 150 * Math.random());

                for (var i = 0; i < length; i++) {
                    text += letters.charAt(Math.floor(Math.random() * letters.length));
                }

                return text;
            };

            var logForever = function() {
                log(randomString());
                setTimeout(logForever, Math.random() * 2000);
            };

            scrollToBottom();
            logForever();
        </script>
    </body>

</html>
